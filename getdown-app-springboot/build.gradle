buildscript {
	repositories {
		maven { url "http://repo.spring.io/plugins-release" }
	}
	dependencies {
		classpath("org.springframework.boot:spring-boot-gradle-plugin:$spring_boot_version")
		classpath('se.transmode.gradle:gradle-docker:1.2')
	}
}


//plugins
apply plugin: 'application'
apply plugin: 'spring-boot'
apply plugin: 'docker'

group = 'coreos.vm:5000'

mainClassName = 'io.github.lumue.getdown.app.springboot.application.Application'

repositories {
	maven { url 'http://repo.spring.io/libs-release' }
	maven { url 'http://repo.springsource.org/libs-milestone' }
  }

dependencies {
	compile project(':getdown-core')	
	compile project(':getdown-webconsole')
	compile project(':getdown-hosts-common')
	
	
	compile("org.springframework.boot:spring-boot-starter-web")
	compile("org.springframework.boot:spring-boot-starter-logging")
	compile("org.springframework.boot:spring-boot-starter-websocket")
	
	compile("org.springframework:spring-messaging")
	compile("io.projectreactor.spring:reactor-spring-context:$reactor_version")
	testCompile("org.springframework.boot:spring-boot-starter-test")
}


eclipse {
		project { 
			natures 'org.springframework.ide.eclipse.core.springnature'
			buildCommand 'org.springframework.ide.eclipse.core.springbuilder'		
		}
}

task buildDocker(type: Docker, dependsOn: build) {
	
	push = true
	applicationName = jar.baseName
	
	dockerfile = file('src/main/docker/Dockerfile')
	
	doFirst {
	  copy {
		from jar
		into stageDir
	  }
	}
	
  }

