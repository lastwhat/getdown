<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="download-view">
	<template>

		<style>
			:host {
				display: block;
			}

			.content {
				padding: 16px;
				height: 100%;
			}


		</style>

		<download-data id="data"
		               active="{{active}}"
		               waiting="{{waiting}}"
		               finished="{{finished}}"
		               failed="{{failed}}">
		</download-data>

		<paper-toolbar id="toolbar">
			<paper-icon-button id="paperToggle" icon="menu" paper-drawer-toggle></paper-icon-button>
			<span class="title">downloads</span>
			<paper-icon-button icon="refresh" on-tap="refresh"></paper-icon-button>
			<paper-icon-button icon="add" on-tap="_toggleAddDownload">+</paper-icon-button>
		</paper-toolbar>

		<!-- Main Content -->
		<div class="content">
			<download-list-widget title="running" downloads="{{active}}"
			                      on-cancel="_handleCancel"
			                      on-delete="_handleDelete"
			                      on-restart="_handleRestart">

			</download-list-widget>
			<download-list-widget title="waiting" downloads="{{waiting}}"
			                      on-cancel="_handleCancel"
			                      on-delete="_handleDelete"
			                      on-restart="_handleRestart">

			</download-list-widget>
			<download-list-widget title="finished" downloads="{{finished}}"
			                      on-cancel="_handleCancel"
			                      on-delete="_handleDelete"
			                      on-restart="_handleRestart">

			</download-list-widget>
			<download-list-widget title="canceled" downloads="{{canceled}}"
			                      on-cancel="_handleCancel"
			                      on-delete="_handleDelete"
			                      on-restart="_handleRestart">

			</download-list-widget>
			<download-list-widget title="failed" downloads="{{failed}}"
			                      on-cancel="_handleCancel"
			                      on-delete="_handleDelete"
			                      on-restart="_handleRestart">

			</download-list-widget>
		</div>

		<add-download-dialog id="adddialog" url="{{newurl}}"
		                     on-cancel="_cancelAddDownload"
		                     on-confirm="_confirmAddDownload">
		</add-download-dialog>

	</template>
	<script>
		(function () {
			'use strict';

			Polymer({
				is: 'download-view',

				properties: {
					active: {
						type: Array,
						notify: true
					},
					waiting: {
						type: Array,
						notify: true
					},
					failed: {
						type: Array,
						notify: true
					},
					finished: {
						type: Array,
						notify: true
					},
					finished: {
						type: Array,
						notify: true
					},
					canceled: {
						type: Array,
						notify: true
					},
					newurl: {
						type: Array,
						notify: true
					}
				},

				refresh: function () {
					this.$.data.reload()
				},

				_toggleAddDownload: function () {
					this.$.adddialog.toggle()
				},

				_cancelAddDownload: function () {
					this._toggleAddDownload()
				},

				_confirmAddDownload: function () {
					this.$.data.addDownload(this.newurl)
					this._toggleAddDownload()
				},
				_handleCancel: function (event) {
					this.$.data.cancelDownload(event.detail.handle)
				},
				_handleDelete: function (event) {
					this.$.data.removeDownload(event.detail.handle)
				},
				_handleRestart: function (event) {
					this.$.data.restartDownload(event.detail.handle)
				}


			});
		})();
	</script>
</dom-module>
